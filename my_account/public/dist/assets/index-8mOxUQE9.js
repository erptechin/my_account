import{u as E,t as V,a as n,v as S,w as B,j as t,B as A,h as d,C as L,x as U,y as G,z as w,D as H,E as O,G as q}from"./index-ncicVzZt.js";import{u as J,a as W,b as K,C as Q,c as X,F as Y,T as Z,f as u,d as $,e as ee,S as te,g as se,P as re,h as ae,i as le,j as ne,k as j,l as oe,m as ie,n as de,o as ce,p as ge}from"./getUserAgentBrowser-BKoQ7ost.js";import{P as ue}from"./Page-GDURQcbQ.js";import{u as me,a as fe}from"./useApiHook-eP_9u3qF.js";import"./Datepicker-Ce_LiJN5.js";import"./transition-Dmw7rjwb.js";import"./floating-ui.dom-CtcSe9Ld.js";import"./XMarkIcon-CefDSuyr.js";import"./listbox-u5L8ttvt.js";import"./frozen-Cr8m4JQ1.js";import"./use-text-value-kjyO-tD5.js";import"./iconBase-CISmb_qU.js";import"./menu-Bocl6HGc.js";import"./index-C53P6BeS.js";import"./popover-DTctezvM.js";import"./active-element-history-BaoVivUy.js";import"./useUnmount-CC7n5X-V.js";import"./useMutation-zCcxsaHQ.js";const pe=ge()==="Safari",m="Payment Plan",f="Payment Plan",xe=["current_balance","total_amount","dob","defendant_first_name","defendant_last_name","previous_payment_date","payment_status"];function De(){const{cardSkin:y}=E(),C=V(),[k,p]=J(),[x,c]=n.useState([]),{data:r}=me({doctype:f,fields:JSON.stringify(xe)}),[g,b]=n.useState({doctype:f,page:1,page_length:10,fields:null}),{data:o}=fe(g);n.useEffect(()=>{if(r!=null&&r.fields){const s=r==null?void 0:r.fields.map(e=>e.fieldname);b({...g,fields:JSON.stringify([...s,"name"])})}},[r]),n.useEffect(()=>{if(o!=null&&o.data){const s=o.data.map(e=>{const i=e&&e.current_balance/e.total_amount*100||0;return{...e,progress:i.toFixed(0)}});c(s)}},[o]);const[a,R]=n.useState({enableSorting:!0,enableColumnFilters:!0,enableFullScreen:!1,enableRowDense:!1}),[F,P]=n.useState(""),[N,v]=n.useState([]),[_,I]=S("column-visibility-orders-2",{}),[M,z]=S("column-pinning-orders-2",{}),h=n.useRef(),{width:T}=W({ref:h}),l=K({data:x,columns:Q(r&&r.fields?[...r.fields,{fieldtype:"Progress",label:"Progress",fieldname:"progress"}]:[]),doctype:f,state:{globalFilter:F,sorting:N,columnVisibility:_,columnPinning:M,tableSettings:a},meta:{setTableSettings:R,deleteRow:s=>{p(),c(e=>e.filter(i=>i.order_id!==s.original.order_id))},deleteRows:s=>{p();const e=s.map(i=>i.original.order_id);c(i=>i.filter(D=>!e.includes(D.order_id)))}},filterFns:{fuzzy:j},enableSorting:a.enableSorting,enableColumnFilters:a.enableColumnFilters,getCoreRowModel:ce(),onGlobalFilterChange:P,getFilteredRowModel:de(),getFacetedUniqueValues:ie(),getFacetedMinMaxValues:oe(),globalFilterFn:j,onSortingChange:v,getSortedRowModel:ne(),getExpandedRowModel:le(),getRowCanExpand:()=>!0,getPaginationRowModel:ae(),onColumnVisibilityChange:I,onColumnPinningChange:z,autoResetPageIndex:k});return B(()=>l.resetRowSelection(),[x]),X(a.enableFullScreen),t.jsx(ue,{title:m,children:t.jsxs("div",{className:"transition-content grid grid-cols-1 grid-rows-[auto_auto_1fr] px-(--margin-x) py-4",children:[t.jsxs("div",{className:"flex items-center justify-between space-x-4 ",children:[t.jsx("div",{className:"min-w-0",children:t.jsxs("h2",{className:"truncate text-xl font-medium tracking-wide text-gray-800 dark:text-dark-50",children:[m," Lists"]})}),t.jsxs(A,{className:"h-8 space-x-1.5 rounded-md px-3 text-xs ",color:"primary",onClick:()=>C("add-new"),children:[t.jsx(Y,{className:"size-5"}),t.jsxs("span",{children:["New ",m]})]})]}),t.jsxs("div",{className:d("flex flex-col pt-4",a.enableFullScreen&&"fixed inset-0 z-61 h-full w-full bg-white pt-3 dark:bg-dark-900"),children:[t.jsx(Z,{table:l}),t.jsxs(L,{className:d("relative mt-3 flex grow flex-col",a.enableFullScreen&&"overflow-hidden"),ref:h,children:[t.jsx("div",{className:"table-wrapper min-w-full grow overflow-x-auto",children:t.jsxs(U,{hoverable:!0,dense:a.enableRowDense,sticky:a.enableFullScreen,className:"w-full text-left rtl:text-right",children:[t.jsx(G,{children:l.getHeaderGroups().map(s=>t.jsx(w,{children:s.headers.map(e=>t.jsxs(H,{className:d("bg-gray-200 font-semibold uppercase text-gray-800 dark:bg-dark-800 dark:text-dark-100 first:ltr:rounded-tl-lg last:ltr:rounded-tr-lg first:rtl:rounded-tr-lg last:rtl:rounded-tl-lg",e.column.getCanPin()&&[e.column.getIsPinned()==="left"&&"sticky z-2 ltr:left-0 rtl:right-0",e.column.getIsPinned()==="right"&&"sticky z-2 ltr:right-0 rtl:left-0"]),children:[e.column.getCanSort()?t.jsxs("div",{className:"flex cursor-pointer select-none items-center space-x-3 ",onClick:e.column.getToggleSortingHandler(),children:[t.jsx("span",{className:"flex-1",children:e.isPlaceholder?null:u(e.column.columnDef.header,e.getContext())}),t.jsx($,{sorted:e.column.getIsSorted()})]}):e.isPlaceholder?null:u(e.column.columnDef.header,e.getContext()),e.column.getCanFilter()?t.jsx(ee,{column:e.column}):null]},e.id))},s.id))}),t.jsx(O,{children:l.getRowModel().rows.map(s=>t.jsxs(n.Fragment,{children:[t.jsx(w,{className:d("relative border-y border-transparent border-b-gray-200 dark:border-b-dark-500",s.getIsExpanded()&&"border-dashed",s.getIsSelected()&&!pe&&"row-selected after:pointer-events-none after:absolute after:inset-0 after:z-2 after:h-full after:w-full after:border-3 after:border-transparent after:bg-primary-500/10 ltr:after:border-l-primary-500 rtl:after:border-r-primary-500"),children:s.getVisibleCells().map(e=>t.jsxs(q,{className:d("relative",y==="shadow-sm"?"dark:bg-dark-700":"dark:bg-dark-900",e.column.getCanPin()&&[e.column.getIsPinned()==="left"&&"sticky z-2 ltr:left-0 rtl:right-0",e.column.getIsPinned()==="right"&&"sticky z-2 ltr:right-0 rtl:left-0"]),children:[e.column.getIsPinned()&&t.jsx("div",{className:d("pointer-events-none absolute inset-0 border-gray-200 dark:border-dark-500",e.column.getIsPinned()==="left"?"ltr:border-r rtl:border-l":"ltr:border-l rtl:border-r")}),u(e.column.columnDef.cell,e.getContext())]},e.id))}),s.getIsExpanded()&&t.jsx("tr",{children:t.jsx("td",{colSpan:s.getVisibleCells().length,className:"p-0",children:t.jsx(te,{row:s,cardWidth:T})})})]},s.id))})]})}),t.jsx(se,{table:l}),l.getCoreRowModel().rows.length>0&&t.jsx("div",{className:d("px-4 pb-4 sm:px-5 sm:pt-4",a.enableFullScreen&&"bg-gray-50 dark:bg-dark-800",!(l.getIsSomeRowsSelected()||l.getIsAllRowsSelected())&&"pt-4"),children:t.jsx(re,{table:l,count:(o==null?void 0:o.counts)??0,search:g,setSearch:b})})]})]})]})})}export{De as default};
