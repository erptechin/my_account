import{u as D,t as E,H as P,a as n,j as t,S as C,B as d,P as A}from"./index-SXvdugQT.js";import{u as B,o as I}from"./index.esm-C9JgoV06.js";import{S as O,D as R}from"./dynamicForms-CPnanlZZ.js";import{P as T}from"./Page-ePkDMtiu.js";import{u as U,b as z,c as H,d as J}from"./useApiHook-DVSrb5wT.js";import{F as q}from"./DocumentPlusIcon-DOpn147v.js";import"./popover-CT0B8Z7G.js";import"./transition-NUWvo8g1.js";import"./floating-ui.dom-CtcSe9Ld.js";import"./active-element-history-D83MWUsz.js";import"./frozen-75WgHLkO.js";import"./XMarkIcon-ClGpFXaW.js";import"./Datepicker-Cc7Jmv4p.js";import"./combobox-Db0GUVKq.js";import"./index-dOFS1BQK.js";import"./iconBase-CH2KRiBw.js";import"./useUnmount--bT9BEl7.js";import"./useMutation-DBkUJsSz.js";const u="Payment Details",o="Fine Transaction",G={transaction_table:{date:!0,mode_of_payment:!0,payment_source:!0,amount:!0},contempt_fee_table:{component:!0,costs:!0,disbursed_amount:!0},component_table:{components:!0,costs:!0,fine_dispurse:!0,date:!0}};function ne(){const{isDark:p,darkColorScheme:f,lightColorScheme:x}=D(),i=E(),{id:a}=P(),[l,h]=n.useState(null),[g,j]=n.useState({}),{data:e,isFetching:y}=U({doctype:o}),{data:r,isFetching:S}=z({doctype:o,id:a,fields:l?JSON.stringify(l):null});n.useEffect(()=>{if(e!=null&&e.fields){let s=e==null?void 0:e.fields.map(m=>m.fieldname);h(s),j(Object.fromEntries(s.map(m=>[m,""])))}},[e==null?void 0:e.fields]);const b=H(s=>{s&&(c(),i(-1))}),N=J(s=>{s&&(c(),i(-1))}),{register:F,handleSubmit:v,formState:{errors:_},control:w,reset:c}=B({resolver:I(O(e==null?void 0:e.fields)),values:a?r:g}),k=s=>{a?N.mutate({doctype:o,body:{...s,id:a}}):b.mutate({doctype:o,body:s})};return y||S?t.jsx(C,{style:{"--sk-color":p?f[700]:x[300]}}):t.jsx(T,{title:(a?"Edit ":"New ")+u,children:t.jsxs("div",{className:"transition-content px-(--margin-x) pb-6",children:[t.jsxs("div",{className:"flex flex-col items-center justify-between space-y-4 py-5 sm:flex-row sm:space-y-0 lg:py-6",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(q,{className:"size-6"}),t.jsxs("h2",{className:"line-clamp-1 text-xl font-medium text-gray-700 dark:text-dark-50",children:[a?"Edit":"New"," ",u]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(d,{className:"min-w-[7rem]",variant:"outlined",color:"error",onClick:()=>i(-1),children:"Back"}),t.jsx(d,{className:"min-w-[7rem]",color:"primary",type:"submit",form:"new-post-form",children:"Save"})]})]}),t.jsx("div",{className:"py-5",children:t.jsx(A,{color:"success",value:r&&r.unpaid_amount/r.fine_amount*100||0})}),t.jsx("form",{autoComplete:"off",onSubmit:v(k),id:"new-post-form",children:t.jsx(R,{infos:e==null?void 0:e.fields,tables:G,register:F,control:w,errors:_})})]})})}export{ne as default};
