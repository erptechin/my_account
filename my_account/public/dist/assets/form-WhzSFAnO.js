import{u as E,t as C,H as D,a as m,j as t,S as _,B as c}from"./index-SXvdugQT.js";import{u as A,o as B}from"./index.esm-C9JgoV06.js";import{S as I,D as P}from"./dynamicForms-CPnanlZZ.js";import{P as O}from"./Page-ePkDMtiu.js";import{u as R,b as U,c as z,d as H}from"./useApiHook-DVSrb5wT.js";import{F as J}from"./DocumentPlusIcon-DOpn147v.js";import"./popover-CT0B8Z7G.js";import"./transition-NUWvo8g1.js";import"./floating-ui.dom-CtcSe9Ld.js";import"./active-element-history-D83MWUsz.js";import"./frozen-75WgHLkO.js";import"./XMarkIcon-ClGpFXaW.js";import"./Datepicker-Cc7Jmv4p.js";import"./combobox-Db0GUVKq.js";import"./index-dOFS1BQK.js";import"./iconBase-CH2KRiBw.js";import"./useUnmount--bT9BEl7.js";import"./useMutation-DBkUJsSz.js";const i="Charge Entry",T={offence_code:{violation_code:!0,docet:!0,violation_codes:!0,description:!0},witness_table:{offence_code:!0,name1:!0,docket:!0}};function oe(){const{isDark:d,darkColorScheme:u,lightColorScheme:p}=E(),r=C(),{id:a}=D(),[l,f]=m.useState(null),[x,h]=m.useState({}),{data:e,isFetching:g}=R({doctype:i}),{data:S,isFetching:j}=U({doctype:i,id:a,fields:l?JSON.stringify(l):null});m.useEffect(()=>{if(e!=null&&e.fields){let s=e==null?void 0:e.fields.map(o=>o.fieldname);f(s),h(Object.fromEntries(s.map(o=>[o,""])))}},[e==null?void 0:e.fields]);const y=z(s=>{s&&(n(),r(-1))}),b=H(s=>{s&&(n(),r(-1))}),{register:v,handleSubmit:F,formState:{errors:N},control:w,reset:n}=A({resolver:B(I(e==null?void 0:e.fields)),values:a?S:x}),k=s=>{a?b.mutate({doctype:i,body:{...s,id:a}}):y.mutate({doctype:i,body:s})};return g||j?t.jsx(_,{style:{"--sk-color":d?u[700]:p[300]}}):t.jsx(O,{title:(a?"Edit ":"New ")+i,children:t.jsxs("div",{className:"transition-content px-(--margin-x) pb-6",children:[t.jsxs("div",{className:"flex flex-col items-center justify-between space-y-4 py-5 sm:flex-row sm:space-y-0 lg:py-6",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(J,{className:"size-6"}),t.jsxs("h2",{className:"line-clamp-1 text-xl font-medium text-gray-700 dark:text-dark-50",children:[a?"Edit":"New"," ",i]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(c,{className:"min-w-[7rem]",variant:"outlined",color:"error",onClick:()=>r(-1),children:"Back"}),t.jsx(c,{className:"min-w-[7rem]",color:"primary",type:"submit",form:"new-post-form",children:"Save"})]})]}),t.jsx("form",{autoComplete:"off",onSubmit:F(k),id:"new-post-form",children:t.jsx(P,{infos:e==null?void 0:e.fields,tables:T,register:v,control:w,errors:N})})]})})}export{oe as default};
