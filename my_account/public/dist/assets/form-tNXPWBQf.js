import{u as E,t as P,H as D,a as m,j as t,S as C,B as c}from"./index-SXvdugQT.js";import{u as A,o as B}from"./index.esm-C9JgoV06.js";import{S as I,D as O}from"./dynamicForms-CPnanlZZ.js";import{P as R}from"./Page-ePkDMtiu.js";import{u as U,b as z,c as H,d as J}from"./useApiHook-DVSrb5wT.js";import{F as T}from"./DocumentPlusIcon-DOpn147v.js";import"./popover-CT0B8Z7G.js";import"./transition-NUWvo8g1.js";import"./floating-ui.dom-CtcSe9Ld.js";import"./active-element-history-D83MWUsz.js";import"./frozen-75WgHLkO.js";import"./XMarkIcon-ClGpFXaW.js";import"./Datepicker-Cc7Jmv4p.js";import"./combobox-Db0GUVKq.js";import"./index-dOFS1BQK.js";import"./iconBase-CH2KRiBw.js";import"./useUnmount--bT9BEl7.js";import"./useMutation-DBkUJsSz.js";const d="Payment Plan",r="Payment Plan",q={transaction_table:{date:!0,mode_of_payment:!0,payment_source:!0,amount:!0},warrant_fee_table:{components:!0,amount:!0,amount_paid:!0,date:!0},case_table:{case_no:!0,amount:!0,amount_paid:!0,date:!0}};function me(){const{isDark:u,darkColorScheme:p,lightColorScheme:f}=E(),o=P(),{id:a}=D(),[n,x]=m.useState(null),[h,y]=m.useState({}),{data:e,isFetching:g}=U({doctype:r}),{data:S,isFetching:j}=z({doctype:r,id:a,fields:n?JSON.stringify(n):null});m.useEffect(()=>{if(e!=null&&e.fields){let s=e==null?void 0:e.fields.map(i=>i.fieldname);x(s),y(Object.fromEntries(s.map(i=>[i,""])))}},[e==null?void 0:e.fields]);const b=H(s=>{s&&(l(),o(-1))}),N=J(s=>{s&&(l(),o(-1))}),{register:F,handleSubmit:v,formState:{errors:w},control:_,reset:l}=A({resolver:B(I(e==null?void 0:e.fields)),values:a?S:h}),k=s=>{a?N.mutate({doctype:r,body:{...s,id:a}}):b.mutate({doctype:r,body:s})};return g||j?t.jsx(C,{style:{"--sk-color":u?p[700]:f[300]}}):t.jsx(R,{title:(a?"Edit ":"New ")+d,children:t.jsxs("div",{className:"transition-content px-(--margin-x) pb-6",children:[t.jsxs("div",{className:"flex flex-col items-center justify-between space-y-4 py-5 sm:flex-row sm:space-y-0 lg:py-6",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(T,{className:"size-6"}),t.jsxs("h2",{className:"line-clamp-1 text-xl font-medium text-gray-700 dark:text-dark-50",children:[a?"Edit":"New"," ",d]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(c,{className:"min-w-[7rem]",variant:"outlined",color:"error",onClick:()=>o(-1),children:"Back"}),t.jsx(c,{className:"min-w-[7rem]",color:"primary",type:"submit",form:"new-post-form",children:"Save"})]})]}),t.jsx("form",{autoComplete:"off",onSubmit:v(k),id:"new-post-form",children:t.jsx(O,{infos:e==null?void 0:e.fields,tables:q,register:F,control:_,errors:w})})]})})}export{me as default};
